<!DOCTYPE html>
<html lang="id">
<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>EVIDEN LCS DIGITAL</title>

        <!-- ===================== STYLE (CSS) ===================== -->
        <style>
        @page { size: A4; margin: 0; }
        body { font-family: Arial, sans-serif; background: #525659; margin: 0; padding: 0; }
        .kertas-a4 { width: 210mm; min-height: 297mm; padding: 15mm 20mm; margin: 20px auto; background: white; box-sizing: border-box; box-shadow: 0 0 15px rgba(0,0,0,0.5); }
        .judul-laporan { text-align: center; font-weight: bold; font-size: 14pt; margin-bottom: 25px; text-transform: uppercase; line-height: 1.3; }
        .catatan { display: none !important; }        
        .identitas { width: 100% !important; border-collapse: collapse !important; margin-bottom: 20px; font-size: 11pt; table-layout: fixed; border: none !important; }
        .identitas td { padding: 4px 0 !important; vertical-align: top; border: none !important; background: transparent !important; }
        .label-id { width: 140px !important; font-weight: bold; }
        .titik-id { width: 20px !important; text-align: center; font-weight: bold; }
        .identitas input { width: 100% !important; border: none !important; background: transparent !important; outline: none; font-family: Arial; font-size: 11pt; color: black !important; padding: 0 !important; margin: 0 !important; box-sizing: border-box !important; }
        .style-periode { font-weight: bold; text-transform: uppercase; }
        .style-nama { font-weight: normal; }
        
        table.tabel-data { width: 100%; border-collapse: collapse; table-layout: fixed; border: 2px solid black; }
        table.tabel-data th { background-color: #666666; color: white; padding: 10px 5px; border: 1px solid black; font-weight: bold; text-align: center; vertical-align: middle; text-transform: uppercase; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        table.tabel-data td { border: 1px solid black; padding: 0; vertical-align: middle; }
        
        .col-no { width: 110px; }
        .col-judul { width: 180px; }
        .td-no { text-align: center; height: 190px; vertical-align: middle; }
        
        .input-tgl { width: 100% !important; height: 100% !important; border: none !important; text-align: center !important; font-weight: normal !important; font-size: 10pt !important; background: transparent !important; outline: none !important; font-family: Arial, sans-serif !important; color: #000 !important; padding: 0 !important; margin: 0 !important; line-height: normal !important; box-sizing: border-box !important; }
        .judul-wrapper { display: flex !important; align-items: center !important; justify-content: flex-start !important; height: 190px !important; padding: 0 10px !important; box-sizing: border-box !important; margin: 0 !important; }
        textarea.input-judul { width: 100% !important; height: 90px !important; border: none !important; resize: none !important; font-family: Arial, sans-serif !important; font-size: 10pt !important; background: transparent !important; outline: none !important; overflow: hidden !important; line-height: 1.3 !important; padding: 0 !important; margin: 0 !important; box-sizing: border-box !important; }
        
        .foto-container { border-radius: 4px; width: 100px; height: 180px; border: 1px dashed #ccc; margin: 5px auto; position: relative; background-color: #f4f4f4; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .img-preview { width: 100%; height: 100%; object-fit: fill; display: none; }
        .file-input { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer; z-index: 5; }
        .placeholder-text { font-size: 8pt; color: #888; text-align: center; }
        
        .toolbar { padding: max(10px, env(safe-area-inset-top)) 10px 10px 10px; position: fixed; top: 20px; left: 20px; display: flex; flex-direction: column; gap: 5px; z-index: 9999; }
        button, .btn-link { padding: 12px 20px; cursor: pointer; border: none; border-radius: 8px; color: white; font-weight: bold; box-shadow: 2px 2px 5px rgba(0,0,0,0.3); text-decoration: none; display: inline-flex; align-items: center; font-size: 14px; }
        .btn-print { background: #1e7e34; }
        .btn-reset { background: #e74c3c; }
        .btn-lcs { background: #198754; }
        .btn-restore {
            background: #6c757d;
            color: #fff;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
            display: inline-flex;
            align-items: center;
            font-size: 14px;
            cursor: pointer;
            margin-bottom: 4px;
            transition: background 0.2s;
        }
        .btn-restore:hover {
            background: #495057;
        }
        .btn-restore input[type="file"] {
            display: none;
        }

        .action-buttons { text-align: center; margin-top: 15px; display: flex; justify-content: center; gap: 10px; }
        .btn-action { background: #555; padding: 10px 20px; font-size: 14px; }

        @media screen and (max-width: 768px) {
            html, body { margin: 0; padding: 5px; background: #ddd; }
            .kertas-a4 { width: 97%; padding: 15px; margin: 0; box-shadow: none; box-sizing: border-box; }
            .judul-laporan { font-size: 11pt; margin-top: 40px; }
            .identitas td { display: block; width: 100%; }
            .label-id { width: 100% !important; }
            .titik-id { display: none !important; }
            .identitas input { width: 100% !important; border-bottom: 1px solid #ccc !important;  margin-bottom: 10px !important; }
            .catatan { display: block !important; font-size: 11px !important; font-style: italic !important; color:red; margin-bottom: 2px !important;}
            .tabel-data thead { display: none !important; }
            table.tabel-data, .tabel-data tbody, .tabel-data tr, .tabel-data td { display: block; width: 100%; border: none; }
            .tabel-data tr { background: #f9f9f9; border: 1px solid #ddd; border-radius: 10px; margin-bottom: 20px; padding: 15px; box-sizing: border-box; }
            .td-no { height: auto; text-align: center; border: 1px solid #ccc !important; border-radius: 10px; background: white; padding: 10px !important; margin-bottom: 15px; box-sizing: border-box; }
            .td-judul { border: 1px solid #ccc !important; border-radius: 10px; background: white; padding: 10px; margin-bottom: 15px; box-sizing: border-box; display: block; }
            .judul-wrapper { height: auto !important; padding: 0 !important; }
            textarea.input-judul { height: 80px !important; width: 100% !important; border: none !important; background: transparent !important; padding: 0 !important; outline: none !important; resize: none !important; }
            .td-foto { display: inline-block !important; width: 31% !important; vertical-align: top;border-radius: 3px; }
            .foto-container { width: 95%; height: 140px; margin: 0 auto; background: white; }
            
            .toolbar { position: fixed; top: 0; left: 0; right: 0; background: #333; display: flex; flex-direction: row; padding: max(10px, env(safe-area-inset-top)) 10px 10px 10px; gap: 5px; box-sizing: border-box; z-index: 9999; margin: 0; border: none; }
            button, .btn-link { flex: 1; margin: 0 !important; justify-content: center; padding: 10px 5px; font-size: 11px; box-sizing: border-box; width: auto; }
            
            .action-buttons { margin-bottom: 30px; }
        }

        @media print {
            html, body { height: auto; overflow: visible; }
            .toolbar, #header, #footer, .sidebar, .comments, .action-buttons { display: none !important; }
            .kertas-a4 { width: 210mm !important; min-height: 297mm !important; height: auto !important; padding: 10mm 20mm !important; margin: 0 !important; border: none !important; box-shadow: none !important; page-break-after: avoid !important; overflow: visible !important; }
            .judul-laporan { width: 110% !important; margin: 0 -5% 15px -5% !important; line-height: 1.1 !important; font-size: 13pt !important; }
            .identitas { margin-top: 40px; margin-bottom: 25px !important; }
            
            table.tabel-data { display: table !important; width: 100% !important; page-break-inside: auto; }
            .tabel-data tr { display: table-row !important; page-break-inside: avoid; page-break-after: auto; }
            .tabel-data td { display: table-cell !important; border: 1px solid black !important; }
            .td-no, .judul-wrapper { height: 165px !important; }
            .foto-container { height: 170px !important; border: none !important; background: transparent !important; }
            .placeholder-text { display: none !important; }
            ::placeholder { color: transparent !important; }
        }
    </style>
</head>
<body>

<!-- ===================== TOOLBAR ===================== -->
<div class="toolbar" id="toolbar">
    <button class="btn-action" style="background:#007bff; margin-bottom:4px;" onclick="simpanSemuaData()">
        <!-- Icon Simpan -->
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:5px; vertical-align: text-bottom;"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline></svg> SIMPAN
    </button>
    <button class="btn-action" style="background:#ffc107; margin-bottom:4px;" onclick="window.location.href='https://nadine15072016.github.io/Ghostscript1/'">
        <!-- Icon Home -->
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:5px; vertical-align: text-bottom;"><path d="M3 9l9-7 9 7"></path><path d="M9 22V12H15V22"></path></svg> HOME
    </button>
    <button class="btn-action" style="background:#17a2b8; margin-bottom:4px;" onclick="backupData()">
        <!-- Icon Backup -->
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:5px; vertical-align: text-bottom;"><path d="M12 5v14m0 0l-6-6m6 6l6-6"/></svg> BACKUP DATA
    </button>
    <label class="btn-restore">
        <!-- Icon Restore -->
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:5px; vertical-align: text-bottom;"><path d="M12 19V5m0 0l-6 6m6-6l6 6"/></svg> RESTORE DATA
        <input type="file" accept="application/json" onchange="restoreData(event)">
    </label>
    <button class="btn-print" style="margin-bottom:4px;" onclick="cetakPDFCustom()">
        <!-- Icon PDF -->
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:5px"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg> PDF
    </button>
    <button class="btn-reset" style="margin-bottom:4px;" onclick="resetData()">
        <!-- Icon Reset -->
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:5px"><path d="M23 4v6h-6"></path><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg> RESET
    </button>
    <a class="btn-link btn-lcs" style="margin-bottom:0;" href="https://dev.epusluh.id/lcs/list">
        <!-- Icon LCS -->
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:5px"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line></svg> LCS
    </a>
</div>

<!-- ===================== KERTAS A4 (ISI UTAMA) ===================== -->
<div class="kertas-a4" id="kertas-a4">
    <!-- Judul Laporan -->
    <div class="judul-laporan">
        LAPORAN PENDERASAN INFORMASI DAN PEMBANGUNAN PERTANIAN<br>
        PENYULUH PERTANIAN TAHUN <span id="tahun-judul">2026</span>
    </div>

    <!-- Form Identitas Penyuluh -->
    <section id="form-identitas">
        <table class="identitas">
            <tbody>
                <tr>
                    <td class="label-id">PERIODE</td>
                    <td class="titik-id">:</td>
                    <td>
                        <select id="periode_bulan" class="style-periode" onchange="updatePeriode()">
                            <option value="Januari">Januari</option>
                            <option value="Februari">Februari</option>
                            <option value="Maret">Maret</option>
                            <option value="April">April</option>
                            <option value="Mei">Mei</option>
                            <option value="Juni">Juni</option>
                            <option value="Juli">Juli</option>
                            <option value="Agustus">Agustus</option>
                            <option value="September">September</option>
                            <option value="Oktober">Oktober</option>
                            <option value="November">November</option>
                            <option value="Desember">Desember</option>
                        </select>
                        <select id="periode_tahun" class="style-periode" onchange="updatePeriode()"></select>
                        <input type="hidden" id="id_periode" class="style-periode" placeholder="Rest Untuk Isi Otomatis" oninput="simpanTeks('id_periode')">
                    </td>
                </tr>
                <tr>
                    <td class="label-id">NAMA PENYULUH</td>
                    <td class="titik-id">:</td>
                    <td><input type="text" id="id_nama" class="style-nama" placeholder="Contoh : TRI FEBRIANTI, A.Md" oninput="this.value = this.value.toUpperCase(); simpanTeks('id_nama')"></td>
                </tr>
                <tr>
                    <td class="label-id">NIP.</td>
                    <td class="titik-id">:</td>
                    <td><input type="text" id="id_nip" placeholder="Contoh : 19920203 2025XX X XXX" maxlength="21" oninput="formatNIP(this); simpanTeks('id_nip')"></td>
                </tr>
                <tr>
                    <td class="label-id">WILAYAH BINAAN</td>
                    <td class="titik-id">:</td>
                    <td><input type="text" id="id_wilayah" placeholder="Contoh : Desa ... Kec. ... Kab. ..." oninput="this.value = this.value.toUpperCase(); simpanTeks('id_wilayah')"></td>
                </tr>
            </tbody>
        </table>
    </section>

    <!-- Tabel Eviden -->
    <section id="tabel-eviden">
        <table class="tabel-data">
            <thead>
                <tr>
                    <th rowspan="2" class="col-no">TANGGAL</th>
                    <th rowspan="2" class="col-judul">Judul Konten</th>
                    <th colspan="3">EVIDEN</th>
                </tr>
                <tr>
                    <th>Like</th>
                    <th>Comen</th>
                    <th>Share</th>
                </tr>
            </thead>
            <tbody id="table-body">
                <!-- Baris eviden akan di-generate oleh JS, default 3 baris -->
            </tbody>
        </table>
    </section>

    <!-- Tombol Aksi -->
    <div class="action-buttons" id="action-buttons">
        <button class="btn-action" onclick="tambahBaris()">
            <!-- Icon Tambah Baris -->
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:5px; vertical-align: text-bottom;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg> Tambah Baris
        </button>
        <button class="btn-action" onclick="hapusBaris()">
            <!-- Icon Hapus Baris -->
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:5px; vertical-align: text-bottom;"><line x1="5" y1="12" x2="19" y2="12"></line></svg> Hapus Baris
        </button>
    </div>
</div>

<!-- ===================== SCRIPT (JAVASCRIPT) ===================== -->
<script>
// ===================== INISIALISASI & VARIABEL GLOBAL =====================

// ===================== FITUR BACKUP & RESTORE DATA =====================
function backupData() {
    const data = {...localStorage};
    const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'eviden-backup-' + new Date().toISOString().slice(0,10) + '.json';
    document.body.appendChild(a);
    a.click();
    setTimeout(() => {
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }, 100);
}

function restoreData(event) {
    const file = event.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const data = JSON.parse(e.target.result);
            if (typeof data !== 'object' || Array.isArray(data)) throw new Error('Format tidak valid');
            if (confirm('Data lama akan diganti dengan data backup. Lanjutkan?')) {
                localStorage.clear();
                for (const key in data) {
                    localStorage.setItem(key, data[key]);
                }
                alert('Restore berhasil! Halaman akan dimuat ulang.');
                location.reload();
            }
        } catch (err) {
            alert('File backup tidak valid!');
        }
    };
    reader.readAsText(file);
    // Reset input agar bisa upload file yang sama lagi jika perlu
    event.target.value = '';
}
var tbody = document.getElementById('table-body');
var jumlahBaris = parseInt(localStorage.getItem('jumlahBaris')) || 1;

// ===================== EVENT: ISI OTOMATIS PERIODE DENGAN PICKER =====================
document.addEventListener('DOMContentLoaded', function() {
    // Inisialisasi tahun
    var tahunSelect = document.getElementById('periode_tahun');
    var tahunSekarang = new Date().getFullYear();
    for (var t = tahunSekarang - 5; t <= tahunSekarang + 5; t++) {
        var opt = document.createElement('option');
        opt.value = t;
        opt.text = t;
        tahunSelect.appendChild(opt);
    }
    // Set default bulan dan tahun
    var bulanSelect = document.getElementById('periode_bulan');
    var now = new Date();
    bulanSelect.selectedIndex = now.getMonth();
    tahunSelect.value = tahunSekarang;
    updatePeriode();

    // ===================== INISIALISASI BARIS AWAL =====================
    let jumlahBarisLokal = parseInt(localStorage.getItem('jumlahBaris')) || 1;
    for (let i = 1; i <= jumlahBarisLokal; i++) {
        tbody.appendChild(renderBarisHTML(i));
    }
    if (typeof muatDataLokal === 'function') {
        muatDataLokal();
    }
});

function updatePeriode() {
    var bulan = document.getElementById('periode_bulan').value;
    var tahun = document.getElementById('periode_tahun').value;
    var periodeInput = document.getElementById('id_periode');
    periodeInput.value = bulan + ' ' + tahun;
    // Update tahun pada judul laporan
    var tahunJudul = document.getElementById('tahun-judul');
    if (tahunJudul) tahunJudul.textContent = tahun;
    if (typeof simpanTeks === 'function') simpanTeks('id_periode');
}

// ===================== FUNGSI UTAMA DATA EVIDEN =====================
function simpanSemuaData() {
    // Simpan identitas
    ['id_periode', 'id_nama', 'id_nip', 'id_wilayah'].forEach(id => {
        var el = document.getElementById(id);
        if (el) localStorage.setItem(id, el.value);
    });
    // Simpan data baris
    for (let i = 1; i <= jumlahBaris; i++) {
        var tgl = document.getElementById(`tgl_${i}`);
        var judul = document.getElementById(`judul_${i}`);
        if (tgl) localStorage.setItem(`tgl_${i}`, tgl.value);
        if (judul) localStorage.setItem(`judul_${i}`, judul.value);
        ['like', 'comen', 'share'].forEach(type => {
            var img = document.getElementById(`img_${type}_${i}`);
            if (img && img.src && img.src.startsWith('data:')) {
                localStorage.setItem(`img_${type}_${i}`, img.src);
            }
        });
    }
    localStorage.setItem('jumlahBaris', jumlahBaris);
    alert('Data berhasil disimpan!');
}

function tambahBaris() {
    jumlahBaris++;
    localStorage.setItem('jumlahBaris', jumlahBaris);
    tbody.appendChild(renderBarisHTML(jumlahBaris));
    // Isi tanggal otomatis dari baris sebelumnya jika ada, tanpa mengubah tanggal baris sebelumnya
    var currTgl = document.getElementById(`tgl_${jumlahBaris}`);
    if (jumlahBaris > 1) {
        var prevTgl = document.getElementById(`tgl_${jumlahBaris - 1}`);
        if (prevTgl && currTgl) {
            if (prevTgl.value) {
                currTgl.value = prevTgl.value;
                localStorage.setItem(`tgl_${jumlahBaris}`, currTgl.value);
            } else {
                // Jika baris sebelumnya kosong, isi tanggal hari ini
                var today = new Date();
                var yyyy = today.getFullYear();
                var mm = String(today.getMonth() + 1).padStart(2, '0');
                var dd = String(today.getDate()).padStart(2, '0');
                currTgl.value = `${yyyy}-${mm}-${dd}`;
                localStorage.setItem(`tgl_${jumlahBaris}`, currTgl.value);
            }
        }
    } else if (currTgl) {
        // Jika baris pertama, isi tanggal hari ini
        var today = new Date();
        var yyyy = today.getFullYear();
        var mm = String(today.getMonth() + 1).padStart(2, '0');
        var dd = String(today.getDate()).padStart(2, '0');
        currTgl.value = `${yyyy}-${mm}-${dd}`;
        localStorage.setItem(`tgl_${jumlahBaris}`, currTgl.value);
    }
    // Tidak perlu muat ulang data lokal agar input lain tetap sinkron, cukup baris baru saja
}

function hapusBaris() {
    if (jumlahBaris > 1) {
        if(confirm("Hapus baris terakhir? Eviden di baris ini akan hilang.")) {
            const barisTerakhir = document.getElementById(`baris_${jumlahBaris}`);
            if (barisTerakhir) {
                barisTerakhir.remove();
            }
            localStorage.removeItem(`tgl_${jumlahBaris}`);
            localStorage.removeItem(`judul_${jumlahBaris}`);
            localStorage.removeItem(`img_like_${jumlahBaris}`);
            localStorage.removeItem(`img_comen_${jumlahBaris}`);
            localStorage.removeItem(`img_share_${jumlahBaris}`);
            jumlahBaris--;
            localStorage.setItem('jumlahBaris', jumlahBaris);
        }
    } else {
        alert("Minimal harus ada 1 baris eviden.");
    }
}

function renderBarisHTML(i) {
    // Membuat elemen baris eviden baru
    const tr = document.createElement('tr');
    tr.id = `baris_${i}`;
    tr.innerHTML = `
        <td class="td-no">
            <input type="date" id="tgl_${i}" class="input-tgl" oninput="sinkronisasiTanggal(this)">
        </td>
        <td class="td-judul">
            <div class="judul-wrapper">
                <textarea id="judul_${i}" class="input-judul" placeholder="Isi Judul Konten" oninput="simpanTeks('judul_${i}')"></textarea>
            </div>
        </td>
        <td class="td-foto">
            <div class="foto-container">
                <span class="placeholder-text" id="txt_like_${i}">Foto<br>Evide Like</span>
                <img src="" id="img_like_${i}" class="img-preview">
                <input type="file" accept="image/*" class="file-input" onchange="prosesGambar(this, 'img_like_${i}', 'txt_like_${i}')">
            </div>
        </td>
        <td class="td-foto">
            <div class="foto-container">
                <span class="placeholder-text" id="txt_comen_${i}">Foto<br>Eviden Comen</span>
                <img src="" id="img_comen_${i}" class="img-preview">
                <input type="file" accept="image/*" class="file-input" onchange="prosesGambar(this, 'img_comen_${i}', 'txt_comen_${i}')">
            </div>
        </td>
        <td class="td-foto">
            <div class="foto-container">
                <span class="placeholder-text" id="txt_share_${i}">Foto<br>Eviden Share</span>
                <img src="" id="img_share_${i}" class="img-preview">
                <input type="file" accept="image/*" class="file-input" onchange="prosesGambar(this, 'img_share_${i}', 'txt_share_${i}')">
            </div>
        </td>
    `;
    return tr;
}

function cetakPDFCustom() {
    window.print();
}

// ===================== FUNGSI BANTUAN =====================
function simpanTeks(id) { 
    localStorage.setItem(id, document.getElementById(id).value); 
}

function prosesGambar(input, imgId, textId) {
    if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById(imgId).src = e.target.result;
            document.getElementById(imgId).style.display = 'block';
            document.getElementById(textId).style.display = 'none';
            try { 
                localStorage.setItem(imgId, e.target.result); 
            } catch (err) {}
        }
        reader.readAsDataURL(input.files[0]);
    }
}

// ===================== FUNGSI FORMAT INPUT =====================
function formatNama(input) {
    let teks = input.value;
    if (teks.includes(',')) {
        let pisah = teks.split(',');
        let nama = pisah[0].toUpperCase();
        let gelar = pisah.slice(1).join(',');
        input.value = nama + ',' + gelar;
    } else {
        input.value = teks.toUpperCase();
    }
}

function formatAlamat(input) {
    let teks = input.value;
    let words = teks.split(' ');
    for (let i = 0; i < words.length; i++) {
        if (words[i].length > 0) {
            words[i] = words[i].charAt(0).toUpperCase() + words[i].substring(1).toLowerCase();
        }
    }
    input.value = words.join(' ');
}

function formatNIP(input) {
    let value = input.value.replace(/\D/g, '');
    if (value.length > 18) {
        value = value.substr(0, 18);
    }
    let formatted = '';
    if (value.length > 0) formatted += value.substr(0, 8);
    if (value.length > 8) formatted += ' ' + value.substr(8, 6);
    if (value.length > 14) formatted += ' ' + value.substr(14, 1);
    if (value.length > 15) formatted += ' ' + value.substr(15, 3);
    input.value = formatted;
}

// ===================== FUNGSI MUAT DATA LOKAL =====================
function muatDataLokal() {
    ['id_periode', 'id_nama', 'id_nip', 'id_wilayah'].forEach(id => { 
        if(localStorage.getItem(id)) {
            document.getElementById(id).value = localStorage.getItem(id); 
        }
    });

    // Sinkronisasi picker bulan/tahun jika ada data lokal
    const pInput = document.getElementById('id_periode');
    if (pInput.value) {
        var parts = pInput.value.split(' ');
        if (parts.length === 2) {
            var bulan = parts[0];
            var tahun = parts[1];
            var bulanSelect = document.getElementById('periode_bulan');
            var tahunSelect = document.getElementById('periode_tahun');
            if (bulanSelect && tahunSelect) {
                bulanSelect.value = bulan;
                tahunSelect.value = tahun;
            }
        }
    }
    updatePeriode();

    for (let i = 1; i <= jumlahBaris; i++) {
        const tEl = document.getElementById(`tgl_${i}`);
        if(localStorage.getItem(`tgl_${i}`)) {
            tEl.value = localStorage.getItem(`tgl_${i}`);
        }
        if(localStorage.getItem(`judul_${i}`)) {
            document.getElementById(`judul_${i}`).value = localStorage.getItem(`judul_${i}`);
        }
        ['like', 'comen', 'share'].forEach(type => {
            const key = `img_${type}_${i}`;
            if (localStorage.getItem(key)) {
                document.getElementById(key).src = localStorage.getItem(key);
                document.getElementById(key).style.display = 'block';
                document.getElementById(`txt_${type}_${i}`).style.display = 'none';
            }
        });
    }
}

// ===================== FUNGSI RESET =====================
function resetData() { 
    if(confirm("Hapus semua data?")) { 
        localStorage.clear(); 
        location.reload(); 
    } 
}
    </script>


<div style="clear: both;"></div>
</div>
</div>
</div></div>
</div>
</main>
</div>
<script type="text/javascript">
</script>
</body>
</html>